import type { NextPage } from 'next';
import dynamic from 'next/dynamic';
import Head from 'next/head';
import Image from 'next/image';
import { Suspense, useEffect, useState } from 'react';
import styles from '../styles/home/Home.module.scss';
import { Session } from '@supabase/supabase-js';
import Link from 'next/link';
import { useRouter } from 'next/router';
import { client } from '../utils/supabase';
import { Footer } from '../components/core/footer/footer';
import { Header } from '../components/core/headers/basicHeader/basicHeader';
import { useAuth } from '../hooks/useAuth';

const Canvas = dynamic(() => import('../components/landingPageCanvas/canvas'), {
  ssr: false,
});

const Home: NextPage = () => {
  const [isSsr, setIsSsr] = useState<boolean>(true); // andere manier fixen
  const { session, user } = useAuth();

  useEffect(() => {
    setIsSsr(false);
    console.log(session);
  }, []);

  return (
    <div className={styles.container}>
      <Head>
        <title>Corita&apos;s dream</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Header showLogo={false} />
      <main className={styles.main}>
        <section className={styles.contentContainer}>
          <h1 className={styles.title}>Corita&apos;s dream </h1>
          <p className={styles.description}>
            An immersive experience that puts a magnifying glass on the ideals
            of Corita Kent. This experience is inspired by the exhibition
            Everyday, Someday and Other Stories, which can be viewed in the
            Stedelijk Museum, where developments in visual art and design from
            the 1950s to the 1980s.
          </p>
          <p className={styles.description}>
            Artists and designers show that it is a time of new possibilities
            and progress, of mass culture, pop culture and consumption, but also
            of criticism of the established order.
          </p>
          <p className={styles.description}>
            Corita is one of these revolutionary artists.
          </p>
        </section>
        <section className={styles.buttonContainer}>
          <Link href={!session ? '/signin' : '/dream'}>
            <a className={styles.button}>Start Experience</a>
          </Link>
        </section>
      </main>
      <Footer />
      {renderCanvas()}
    </div>
  );

  function renderCanvas() {
    if (isSsr) {
      return null;
    }

    return (
      <Suspense fallback={null}>
        <Canvas />
      </Suspense>
    );
  }
};

export default Home;
